<!doctype html>

<html lang="en">

<head>
	<meta charset="utf-8">

	<title>Platfora Challenge</title>
	<meta name="author" content="Afshin Mokhtari">

	<script src="react.js"></script>
	<script src="JSXTransformer.js"></script>

	<script src="js/app.js"></script>

	<link rel="stylesheet" href="css/styles.css">
</head>

<body>
	<div id='dlMgr-container'>
	</div>
	<script type="text/jsx">

	  var Header = React.createClass({
			render: function() {
				return (
					<header>
						<h3>Download Manager</h3>
					</header>
				);
			}
		});


		var FilesList = React.createClass({
				getInitialState: function() {
					return { fnameToAdd: '', fList : [] };
				},
				updateFname: function(e) {
					this.setState({ fnameToAdd: e.target.value });
					// console.log( this.state.fnameToAdd );
				},
				keypress: function(e) {
					if ( e.keyCode === 13 && this.state.fnameToAdd !== '' ) {
						this.handleAdd();
					}
 				},
				handleAdd: function(e) {
					// console.log('clicked ', e, this.state.fnameToAdd );
					this.state.fList.push( this.state.fnameToAdd );
					this.setState({ fnameToAdd: '' });
				},
				render: function() {
					var fList = this.state.fList.map( function(file) {
						return (
							<li className='oneFile' id='l{this.state.fList.length + 1}' >
								<img className="fileIcon" src="img/file.png" />
								<span className="fileDescription">
									{ file }
								</span>
								<span className="fileControls">
									<progress className="rounded" max="100" value="0"></progress>
									<img className="deleteIcon" src="img/delete.png" />
								</span>
							</li>
						);
					});

					console.log( this.state.fList );

					return (
						<div>
							<ul className='filesList'>
								{ fList }
							</ul>

							<div className='addFileBox altBkgd'>
								<img className='fileIcon' src='img/add.png' />
								<input onChange={this.updateFname} onKeyDown={this.keypress} type="text" name="fileToAdd" className='rounded thinBorder' placeholder='Filename to Add' />
								<button onClick={this.handleAdd} className='addNewFileBtn rounded'>Add</button>
							</div>
						</div>
					);
				}
		});

		var MainSection = React.createClass({
	      render: function() {
	        return (
	          <section className='whiteBkgd centered'>
							<div className='titleAndSearch' >
								Files to download
								<input className='searchInput floatRight' type='search' name='s' placeholder='Find by Name' />
							</div>

							<div className='colHeader'>
								<span className="col1">File Name</span><span className="col2">Progress</span>
							</div>

							<FilesList />
	          </section>
	        );
	      }
	  });

		var Bottom = React.createClass({
			render: function() {
				return (
					<div>
						<button className='downloadAll rounded'>Download All</button>
						<br />
						<br />
					</div>
				);
			}
		});

		var App = React.createClass({
			render: function() {
				return (
					<div>
						<Header />
						<MainSection />
						<Bottom />
					</div>
				)
			}
		});

		React.render(
	    <App />,
	    document.getElementById( 'dlMgr-container' )
	  );
	</script>


</body>

</html>
